"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/keyborg";
exports.ids = ["vendor-chunks/keyborg"];
exports.modules = {

/***/ "(ssr)/./node_modules/keyborg/dist/esm/index.js":
/*!************************************************!*\
  !*** ./node_modules/keyborg/dist/esm/index.js ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   KEYBORG_FOCUSIN: () => (/* binding */ KEYBORG_FOCUSIN),\n/* harmony export */   KEYBORG_FOCUSOUT: () => (/* binding */ KEYBORG_FOCUSOUT),\n/* harmony export */   createKeyborg: () => (/* binding */ createKeyborg),\n/* harmony export */   disposeKeyborg: () => (/* binding */ disposeKeyborg),\n/* harmony export */   getLastFocusedProgrammatically: () => (/* binding */ getLastFocusedProgrammatically),\n/* harmony export */   nativeFocus: () => (/* binding */ nativeFocus),\n/* harmony export */   version: () => (/* binding */ version)\n/* harmony export */ });\n// src/WeakRefInstance.ts\nvar _canUseWeakRef = typeof WeakRef !== \"undefined\";\nvar WeakRefInstance = class {\n  constructor(instance) {\n    if (_canUseWeakRef && typeof instance === \"object\") {\n      this._weakRef = new WeakRef(instance);\n    } else {\n      this._instance = instance;\n    }\n  }\n  /**\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakRef/deref}\n   */\n  deref() {\n    var _a, _b;\n    let instance;\n    if (this._weakRef) {\n      instance = (_a = this._weakRef) == null ? void 0 : _a.deref();\n      if (!instance) {\n        delete this._weakRef;\n      }\n    } else {\n      instance = this._instance;\n      if ((_b = instance == null ? void 0 : instance.isDisposed) == null ? void 0 : _b.call(instance)) {\n        delete this._instance;\n      }\n    }\n    return instance;\n  }\n};\n\n// src/FocusEvent.ts\nvar KEYBORG_FOCUSIN = \"keyborg:focusin\";\nvar KEYBORG_FOCUSOUT = \"keyborg:focusout\";\nfunction canOverrideNativeFocus(win) {\n  const HTMLElement = win.HTMLElement;\n  const origFocus = HTMLElement.prototype.focus;\n  let isCustomFocusCalled = false;\n  HTMLElement.prototype.focus = function focus() {\n    isCustomFocusCalled = true;\n  };\n  const btn = win.document.createElement(\"button\");\n  btn.focus();\n  HTMLElement.prototype.focus = origFocus;\n  return isCustomFocusCalled;\n}\nvar _canOverrideNativeFocus = false;\nfunction nativeFocus(element) {\n  const focus = element.focus;\n  if (focus.__keyborgNativeFocus) {\n    focus.__keyborgNativeFocus.call(element);\n  } else {\n    element.focus();\n  }\n}\nfunction setupFocusEvent(win) {\n  const kwin = win;\n  if (!_canOverrideNativeFocus) {\n    _canOverrideNativeFocus = canOverrideNativeFocus(kwin);\n  }\n  const origFocus = kwin.HTMLElement.prototype.focus;\n  if (origFocus.__keyborgNativeFocus) {\n    return;\n  }\n  kwin.HTMLElement.prototype.focus = focus;\n  const shadowTargets = /* @__PURE__ */ new Set();\n  const focusOutHandler = (e) => {\n    const target = e.target;\n    if (!target) {\n      return;\n    }\n    const event = new CustomEvent(KEYBORG_FOCUSOUT, {\n      cancelable: true,\n      bubbles: true,\n      // Allows the event to bubble past an open shadow root\n      composed: true,\n      detail: {\n        originalEvent: e\n      }\n    });\n    target.dispatchEvent(event);\n  };\n  const focusInHandler = (e) => {\n    const target = e.target;\n    if (!target) {\n      return;\n    }\n    let node = e.composedPath()[0];\n    const currentShadows = /* @__PURE__ */ new Set();\n    while (node) {\n      if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        currentShadows.add(node);\n        node = node.host;\n      } else {\n        node = node.parentNode;\n      }\n    }\n    for (const shadowRootWeakRef of shadowTargets) {\n      const shadowRoot = shadowRootWeakRef.deref();\n      if (!shadowRoot || !currentShadows.has(shadowRoot)) {\n        shadowTargets.delete(shadowRootWeakRef);\n        if (shadowRoot) {\n          shadowRoot.removeEventListener(\"focusin\", focusInHandler, true);\n          shadowRoot.removeEventListener(\"focusout\", focusOutHandler, true);\n        }\n      }\n    }\n    onFocusIn(target, e.relatedTarget || void 0);\n  };\n  const onFocusIn = (target, relatedTarget, originalEvent) => {\n    var _a;\n    const shadowRoot = target.shadowRoot;\n    if (shadowRoot) {\n      for (const shadowRootWeakRef of shadowTargets) {\n        if (shadowRootWeakRef.deref() === shadowRoot) {\n          return;\n        }\n      }\n      shadowRoot.addEventListener(\"focusin\", focusInHandler, true);\n      shadowRoot.addEventListener(\"focusout\", focusOutHandler, true);\n      shadowTargets.add(new WeakRefInstance(shadowRoot));\n      return;\n    }\n    const details = {\n      relatedTarget,\n      originalEvent\n    };\n    const event = new CustomEvent(KEYBORG_FOCUSIN, {\n      cancelable: true,\n      bubbles: true,\n      // Allows the event to bubble past an open shadow root\n      composed: true,\n      detail: details\n    });\n    event.details = details;\n    if (_canOverrideNativeFocus || data.lastFocusedProgrammatically) {\n      details.isFocusedProgrammatically = target === ((_a = data.lastFocusedProgrammatically) == null ? void 0 : _a.deref());\n      data.lastFocusedProgrammatically = void 0;\n    }\n    target.dispatchEvent(event);\n  };\n  const data = kwin.__keyborgData = {\n    focusInHandler,\n    focusOutHandler,\n    shadowTargets\n  };\n  kwin.document.addEventListener(\n    \"focusin\",\n    kwin.__keyborgData.focusInHandler,\n    true\n  );\n  kwin.document.addEventListener(\n    \"focusout\",\n    kwin.__keyborgData.focusOutHandler,\n    true\n  );\n  function focus() {\n    const keyborgNativeFocusEvent = kwin.__keyborgData;\n    if (keyborgNativeFocusEvent) {\n      keyborgNativeFocusEvent.lastFocusedProgrammatically = new WeakRefInstance(\n        this\n      );\n    }\n    return origFocus.apply(this, arguments);\n  }\n  let activeElement = kwin.document.activeElement;\n  while (activeElement && activeElement.shadowRoot) {\n    onFocusIn(activeElement);\n    activeElement = activeElement.shadowRoot.activeElement;\n  }\n  focus.__keyborgNativeFocus = origFocus;\n}\nfunction disposeFocusEvent(win) {\n  const kwin = win;\n  const proto = kwin.HTMLElement.prototype;\n  const origFocus = proto.focus.__keyborgNativeFocus;\n  const keyborgNativeFocusEvent = kwin.__keyborgData;\n  if (keyborgNativeFocusEvent) {\n    kwin.document.removeEventListener(\n      \"focusin\",\n      keyborgNativeFocusEvent.focusInHandler,\n      true\n    );\n    kwin.document.removeEventListener(\n      \"focusout\",\n      keyborgNativeFocusEvent.focusOutHandler,\n      true\n    );\n    for (const shadowRootWeakRef of keyborgNativeFocusEvent.shadowTargets) {\n      const shadowRoot = shadowRootWeakRef.deref();\n      if (shadowRoot) {\n        shadowRoot.removeEventListener(\n          \"focusin\",\n          keyborgNativeFocusEvent.focusInHandler,\n          true\n        );\n        shadowRoot.removeEventListener(\n          \"focusout\",\n          keyborgNativeFocusEvent.focusOutHandler,\n          true\n        );\n      }\n    }\n    keyborgNativeFocusEvent.shadowTargets.clear();\n    delete kwin.__keyborgData;\n  }\n  if (origFocus) {\n    proto.focus = origFocus;\n  }\n}\nfunction getLastFocusedProgrammatically(win) {\n  var _a;\n  const keyborgNativeFocusEvent = win.__keyborgData;\n  return keyborgNativeFocusEvent ? ((_a = keyborgNativeFocusEvent.lastFocusedProgrammatically) == null ? void 0 : _a.deref()) || null : void 0;\n}\n\n// src/Keyborg.ts\nvar _dismissTimeout = 500;\nvar _lastId = 0;\nvar KeyborgCore = class {\n  constructor(win, props) {\n    this._isNavigatingWithKeyboard_DO_NOT_USE = false;\n    this._onFocusIn = (e) => {\n      if (this._isMouseOrTouchUsedTimer) {\n        return;\n      }\n      if (this.isNavigatingWithKeyboard) {\n        return;\n      }\n      const details = e.detail;\n      if (!details.relatedTarget) {\n        return;\n      }\n      if (details.isFocusedProgrammatically || details.isFocusedProgrammatically === void 0) {\n        return;\n      }\n      this.isNavigatingWithKeyboard = true;\n    };\n    this._onMouseDown = (e) => {\n      if (e.buttons === 0 || e.clientX === 0 && e.clientY === 0 && e.screenX === 0 && e.screenY === 0) {\n        return;\n      }\n      this._onMouseOrTouch();\n    };\n    this._onMouseOrTouch = () => {\n      const win = this._win;\n      if (win) {\n        if (this._isMouseOrTouchUsedTimer) {\n          win.clearTimeout(this._isMouseOrTouchUsedTimer);\n        }\n        this._isMouseOrTouchUsedTimer = win.setTimeout(() => {\n          delete this._isMouseOrTouchUsedTimer;\n        }, 1e3);\n      }\n      this.isNavigatingWithKeyboard = false;\n    };\n    this._onKeyDown = (e) => {\n      const isNavigatingWithKeyboard = this.isNavigatingWithKeyboard;\n      if (isNavigatingWithKeyboard) {\n        if (this._shouldDismissKeyboardNavigation(e)) {\n          this._scheduleDismiss();\n        }\n      } else {\n        if (this._shouldTriggerKeyboardNavigation(e)) {\n          this.isNavigatingWithKeyboard = true;\n        }\n      }\n    };\n    this.id = \"c\" + ++_lastId;\n    this._win = win;\n    const doc = win.document;\n    if (props) {\n      const triggerKeys = props.triggerKeys;\n      const dismissKeys = props.dismissKeys;\n      if (triggerKeys == null ? void 0 : triggerKeys.length) {\n        this._triggerKeys = new Set(triggerKeys);\n      }\n      if (dismissKeys == null ? void 0 : dismissKeys.length) {\n        this._dismissKeys = new Set(dismissKeys);\n      }\n    }\n    doc.addEventListener(KEYBORG_FOCUSIN, this._onFocusIn, true);\n    doc.addEventListener(\"mousedown\", this._onMouseDown, true);\n    win.addEventListener(\"keydown\", this._onKeyDown, true);\n    doc.addEventListener(\"touchstart\", this._onMouseOrTouch, true);\n    doc.addEventListener(\"touchend\", this._onMouseOrTouch, true);\n    doc.addEventListener(\"touchcancel\", this._onMouseOrTouch, true);\n    setupFocusEvent(win);\n  }\n  get isNavigatingWithKeyboard() {\n    return this._isNavigatingWithKeyboard_DO_NOT_USE;\n  }\n  set isNavigatingWithKeyboard(val) {\n    if (this._isNavigatingWithKeyboard_DO_NOT_USE !== val) {\n      this._isNavigatingWithKeyboard_DO_NOT_USE = val;\n      this.update();\n    }\n  }\n  dispose() {\n    const win = this._win;\n    if (win) {\n      if (this._isMouseOrTouchUsedTimer) {\n        win.clearTimeout(this._isMouseOrTouchUsedTimer);\n        this._isMouseOrTouchUsedTimer = void 0;\n      }\n      if (this._dismissTimer) {\n        win.clearTimeout(this._dismissTimer);\n        this._dismissTimer = void 0;\n      }\n      disposeFocusEvent(win);\n      const doc = win.document;\n      doc.removeEventListener(KEYBORG_FOCUSIN, this._onFocusIn, true);\n      doc.removeEventListener(\"mousedown\", this._onMouseDown, true);\n      win.removeEventListener(\"keydown\", this._onKeyDown, true);\n      doc.removeEventListener(\"touchstart\", this._onMouseOrTouch, true);\n      doc.removeEventListener(\"touchend\", this._onMouseOrTouch, true);\n      doc.removeEventListener(\"touchcancel\", this._onMouseOrTouch, true);\n      delete this._win;\n    }\n  }\n  isDisposed() {\n    return !!this._win;\n  }\n  /**\n   * Updates all keyborg instances with the keyboard navigation state\n   */\n  update() {\n    var _a, _b;\n    const keyborgs = (_b = (_a = this._win) == null ? void 0 : _a.__keyborg) == null ? void 0 : _b.refs;\n    if (keyborgs) {\n      for (const id of Object.keys(keyborgs)) {\n        Keyborg.update(keyborgs[id], this.isNavigatingWithKeyboard);\n      }\n    }\n  }\n  /**\n   * @returns whether the keyboard event should trigger keyboard navigation mode\n   */\n  _shouldTriggerKeyboardNavigation(e) {\n    var _a;\n    if (e.key === \"Tab\") {\n      return true;\n    }\n    const activeElement = (_a = this._win) == null ? void 0 : _a.document.activeElement;\n    const isTriggerKey = !this._triggerKeys || this._triggerKeys.has(e.keyCode);\n    const isEditable = activeElement && (activeElement.tagName === \"INPUT\" || activeElement.tagName === \"TEXTAREA\" || activeElement.isContentEditable);\n    return isTriggerKey && !isEditable;\n  }\n  /**\n   * @returns whether the keyboard event should dismiss keyboard navigation mode\n   */\n  _shouldDismissKeyboardNavigation(e) {\n    var _a;\n    return (_a = this._dismissKeys) == null ? void 0 : _a.has(e.keyCode);\n  }\n  _scheduleDismiss() {\n    const win = this._win;\n    if (win) {\n      if (this._dismissTimer) {\n        win.clearTimeout(this._dismissTimer);\n        this._dismissTimer = void 0;\n      }\n      const was = win.document.activeElement;\n      this._dismissTimer = win.setTimeout(() => {\n        this._dismissTimer = void 0;\n        const cur = win.document.activeElement;\n        if (was && cur && was === cur) {\n          this.isNavigatingWithKeyboard = false;\n        }\n      }, _dismissTimeout);\n    }\n  }\n};\nvar Keyborg = class _Keyborg {\n  constructor(win, props) {\n    this._cb = [];\n    this._id = \"k\" + ++_lastId;\n    this._win = win;\n    const current = win.__keyborg;\n    if (current) {\n      this._core = current.core;\n      current.refs[this._id] = this;\n    } else {\n      this._core = new KeyborgCore(win, props);\n      win.__keyborg = {\n        core: this._core,\n        refs: { [this._id]: this }\n      };\n    }\n  }\n  static create(win, props) {\n    return new _Keyborg(win, props);\n  }\n  static dispose(instance) {\n    instance.dispose();\n  }\n  /**\n   * Updates all subscribed callbacks with the keyboard navigation state\n   */\n  static update(instance, isNavigatingWithKeyboard) {\n    instance._cb.forEach((callback) => callback(isNavigatingWithKeyboard));\n  }\n  dispose() {\n    var _a;\n    const current = (_a = this._win) == null ? void 0 : _a.__keyborg;\n    if (current == null ? void 0 : current.refs[this._id]) {\n      delete current.refs[this._id];\n      if (Object.keys(current.refs).length === 0) {\n        current.core.dispose();\n        delete this._win.__keyborg;\n      }\n    } else if (true) {\n      console.error(\n        `Keyborg instance ${this._id} is being disposed incorrectly.`\n      );\n    }\n    this._cb = [];\n    delete this._core;\n    delete this._win;\n  }\n  /**\n   * @returns Whether the user is navigating with keyboard\n   */\n  isNavigatingWithKeyboard() {\n    var _a;\n    return !!((_a = this._core) == null ? void 0 : _a.isNavigatingWithKeyboard);\n  }\n  /**\n   * @param callback - Called when the keyboard navigation state changes\n   */\n  subscribe(callback) {\n    this._cb.push(callback);\n  }\n  /**\n   * @param callback - Registered with subscribe\n   */\n  unsubscribe(callback) {\n    const index = this._cb.indexOf(callback);\n    if (index >= 0) {\n      this._cb.splice(index, 1);\n    }\n  }\n  /**\n   * Manually set the keyboard navigtion state\n   */\n  setVal(isNavigatingWithKeyboard) {\n    if (this._core) {\n      this._core.isNavigatingWithKeyboard = isNavigatingWithKeyboard;\n    }\n  }\n};\nfunction createKeyborg(win, props) {\n  return Keyborg.create(win, props);\n}\nfunction disposeKeyborg(instance) {\n  Keyborg.dispose(instance);\n}\n\n// src/index.ts\nvar version = \"2.6.0\";\n\n/*!\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMva2V5Ym9yZy9kaXN0L2VzbS9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sU0FBUyxJQUFxQztBQUNwRDtBQUNBLDRCQUE0QixVQUFVO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFTRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZWFyY2gtaW50ZWxsaWdlbmNlLXVpLy4vbm9kZV9tb2R1bGVzL2tleWJvcmcvZGlzdC9lc20vaW5kZXguanM/MWUyZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvV2Vha1JlZkluc3RhbmNlLnRzXG52YXIgX2NhblVzZVdlYWtSZWYgPSB0eXBlb2YgV2Vha1JlZiAhPT0gXCJ1bmRlZmluZWRcIjtcbnZhciBXZWFrUmVmSW5zdGFuY2UgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGluc3RhbmNlKSB7XG4gICAgaWYgKF9jYW5Vc2VXZWFrUmVmICYmIHR5cGVvZiBpbnN0YW5jZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgdGhpcy5fd2Vha1JlZiA9IG5ldyBXZWFrUmVmKGluc3RhbmNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL1dlYWtSZWYvZGVyZWZ9XG4gICAqL1xuICBkZXJlZigpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGxldCBpbnN0YW5jZTtcbiAgICBpZiAodGhpcy5fd2Vha1JlZikge1xuICAgICAgaW5zdGFuY2UgPSAoX2EgPSB0aGlzLl93ZWFrUmVmKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZGVyZWYoKTtcbiAgICAgIGlmICghaW5zdGFuY2UpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuX3dlYWtSZWY7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGluc3RhbmNlID0gdGhpcy5faW5zdGFuY2U7XG4gICAgICBpZiAoKF9iID0gaW5zdGFuY2UgPT0gbnVsbCA/IHZvaWQgMCA6IGluc3RhbmNlLmlzRGlzcG9zZWQpID09IG51bGwgPyB2b2lkIDAgOiBfYi5jYWxsKGluc3RhbmNlKSkge1xuICAgICAgICBkZWxldGUgdGhpcy5faW5zdGFuY2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfVxufTtcblxuLy8gc3JjL0ZvY3VzRXZlbnQudHNcbnZhciBLRVlCT1JHX0ZPQ1VTSU4gPSBcImtleWJvcmc6Zm9jdXNpblwiO1xudmFyIEtFWUJPUkdfRk9DVVNPVVQgPSBcImtleWJvcmc6Zm9jdXNvdXRcIjtcbmZ1bmN0aW9uIGNhbk92ZXJyaWRlTmF0aXZlRm9jdXMod2luKSB7XG4gIGNvbnN0IEhUTUxFbGVtZW50ID0gd2luLkhUTUxFbGVtZW50O1xuICBjb25zdCBvcmlnRm9jdXMgPSBIVE1MRWxlbWVudC5wcm90b3R5cGUuZm9jdXM7XG4gIGxldCBpc0N1c3RvbUZvY3VzQ2FsbGVkID0gZmFsc2U7XG4gIEhUTUxFbGVtZW50LnByb3RvdHlwZS5mb2N1cyA9IGZ1bmN0aW9uIGZvY3VzKCkge1xuICAgIGlzQ3VzdG9tRm9jdXNDYWxsZWQgPSB0cnVlO1xuICB9O1xuICBjb25zdCBidG4gPSB3aW4uZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgYnRuLmZvY3VzKCk7XG4gIEhUTUxFbGVtZW50LnByb3RvdHlwZS5mb2N1cyA9IG9yaWdGb2N1cztcbiAgcmV0dXJuIGlzQ3VzdG9tRm9jdXNDYWxsZWQ7XG59XG52YXIgX2Nhbk92ZXJyaWRlTmF0aXZlRm9jdXMgPSBmYWxzZTtcbmZ1bmN0aW9uIG5hdGl2ZUZvY3VzKGVsZW1lbnQpIHtcbiAgY29uc3QgZm9jdXMgPSBlbGVtZW50LmZvY3VzO1xuICBpZiAoZm9jdXMuX19rZXlib3JnTmF0aXZlRm9jdXMpIHtcbiAgICBmb2N1cy5fX2tleWJvcmdOYXRpdmVGb2N1cy5jYWxsKGVsZW1lbnQpO1xuICB9IGVsc2Uge1xuICAgIGVsZW1lbnQuZm9jdXMoKTtcbiAgfVxufVxuZnVuY3Rpb24gc2V0dXBGb2N1c0V2ZW50KHdpbikge1xuICBjb25zdCBrd2luID0gd2luO1xuICBpZiAoIV9jYW5PdmVycmlkZU5hdGl2ZUZvY3VzKSB7XG4gICAgX2Nhbk92ZXJyaWRlTmF0aXZlRm9jdXMgPSBjYW5PdmVycmlkZU5hdGl2ZUZvY3VzKGt3aW4pO1xuICB9XG4gIGNvbnN0IG9yaWdGb2N1cyA9IGt3aW4uSFRNTEVsZW1lbnQucHJvdG90eXBlLmZvY3VzO1xuICBpZiAob3JpZ0ZvY3VzLl9fa2V5Ym9yZ05hdGl2ZUZvY3VzKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGt3aW4uSFRNTEVsZW1lbnQucHJvdG90eXBlLmZvY3VzID0gZm9jdXM7XG4gIGNvbnN0IHNoYWRvd1RhcmdldHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuICBjb25zdCBmb2N1c091dEhhbmRsZXIgPSAoZSkgPT4ge1xuICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KEtFWUJPUkdfRk9DVVNPVVQsIHtcbiAgICAgIGNhbmNlbGFibGU6IHRydWUsXG4gICAgICBidWJibGVzOiB0cnVlLFxuICAgICAgLy8gQWxsb3dzIHRoZSBldmVudCB0byBidWJibGUgcGFzdCBhbiBvcGVuIHNoYWRvdyByb290XG4gICAgICBjb21wb3NlZDogdHJ1ZSxcbiAgICAgIGRldGFpbDoge1xuICAgICAgICBvcmlnaW5hbEV2ZW50OiBlXG4gICAgICB9XG4gICAgfSk7XG4gICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICB9O1xuICBjb25zdCBmb2N1c0luSGFuZGxlciA9IChlKSA9PiB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IG5vZGUgPSBlLmNvbXBvc2VkUGF0aCgpWzBdO1xuICAgIGNvbnN0IGN1cnJlbnRTaGFkb3dzID0gLyogQF9fUFVSRV9fICovIG5ldyBTZXQoKTtcbiAgICB3aGlsZSAobm9kZSkge1xuICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSkge1xuICAgICAgICBjdXJyZW50U2hhZG93cy5hZGQobm9kZSk7XG4gICAgICAgIG5vZGUgPSBub2RlLmhvc3Q7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IHNoYWRvd1Jvb3RXZWFrUmVmIG9mIHNoYWRvd1RhcmdldHMpIHtcbiAgICAgIGNvbnN0IHNoYWRvd1Jvb3QgPSBzaGFkb3dSb290V2Vha1JlZi5kZXJlZigpO1xuICAgICAgaWYgKCFzaGFkb3dSb290IHx8ICFjdXJyZW50U2hhZG93cy5oYXMoc2hhZG93Um9vdCkpIHtcbiAgICAgICAgc2hhZG93VGFyZ2V0cy5kZWxldGUoc2hhZG93Um9vdFdlYWtSZWYpO1xuICAgICAgICBpZiAoc2hhZG93Um9vdCkge1xuICAgICAgICAgIHNoYWRvd1Jvb3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImZvY3VzaW5cIiwgZm9jdXNJbkhhbmRsZXIsIHRydWUpO1xuICAgICAgICAgIHNoYWRvd1Jvb3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImZvY3Vzb3V0XCIsIGZvY3VzT3V0SGFuZGxlciwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgb25Gb2N1c0luKHRhcmdldCwgZS5yZWxhdGVkVGFyZ2V0IHx8IHZvaWQgMCk7XG4gIH07XG4gIGNvbnN0IG9uRm9jdXNJbiA9ICh0YXJnZXQsIHJlbGF0ZWRUYXJnZXQsIG9yaWdpbmFsRXZlbnQpID0+IHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3Qgc2hhZG93Um9vdCA9IHRhcmdldC5zaGFkb3dSb290O1xuICAgIGlmIChzaGFkb3dSb290KSB7XG4gICAgICBmb3IgKGNvbnN0IHNoYWRvd1Jvb3RXZWFrUmVmIG9mIHNoYWRvd1RhcmdldHMpIHtcbiAgICAgICAgaWYgKHNoYWRvd1Jvb3RXZWFrUmVmLmRlcmVmKCkgPT09IHNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNoYWRvd1Jvb3QuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzaW5cIiwgZm9jdXNJbkhhbmRsZXIsIHRydWUpO1xuICAgICAgc2hhZG93Um9vdC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNvdXRcIiwgZm9jdXNPdXRIYW5kbGVyLCB0cnVlKTtcbiAgICAgIHNoYWRvd1RhcmdldHMuYWRkKG5ldyBXZWFrUmVmSW5zdGFuY2Uoc2hhZG93Um9vdCkpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBkZXRhaWxzID0ge1xuICAgICAgcmVsYXRlZFRhcmdldCxcbiAgICAgIG9yaWdpbmFsRXZlbnRcbiAgICB9O1xuICAgIGNvbnN0IGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KEtFWUJPUkdfRk9DVVNJTiwge1xuICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICAvLyBBbGxvd3MgdGhlIGV2ZW50IHRvIGJ1YmJsZSBwYXN0IGFuIG9wZW4gc2hhZG93IHJvb3RcbiAgICAgIGNvbXBvc2VkOiB0cnVlLFxuICAgICAgZGV0YWlsOiBkZXRhaWxzXG4gICAgfSk7XG4gICAgZXZlbnQuZGV0YWlscyA9IGRldGFpbHM7XG4gICAgaWYgKF9jYW5PdmVycmlkZU5hdGl2ZUZvY3VzIHx8IGRhdGEubGFzdEZvY3VzZWRQcm9ncmFtbWF0aWNhbGx5KSB7XG4gICAgICBkZXRhaWxzLmlzRm9jdXNlZFByb2dyYW1tYXRpY2FsbHkgPSB0YXJnZXQgPT09ICgoX2EgPSBkYXRhLmxhc3RGb2N1c2VkUHJvZ3JhbW1hdGljYWxseSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmRlcmVmKCkpO1xuICAgICAgZGF0YS5sYXN0Rm9jdXNlZFByb2dyYW1tYXRpY2FsbHkgPSB2b2lkIDA7XG4gICAgfVxuICAgIHRhcmdldC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfTtcbiAgY29uc3QgZGF0YSA9IGt3aW4uX19rZXlib3JnRGF0YSA9IHtcbiAgICBmb2N1c0luSGFuZGxlcixcbiAgICBmb2N1c091dEhhbmRsZXIsXG4gICAgc2hhZG93VGFyZ2V0c1xuICB9O1xuICBrd2luLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgXCJmb2N1c2luXCIsXG4gICAga3dpbi5fX2tleWJvcmdEYXRhLmZvY3VzSW5IYW5kbGVyLFxuICAgIHRydWVcbiAgKTtcbiAga3dpbi5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxuICAgIFwiZm9jdXNvdXRcIixcbiAgICBrd2luLl9fa2V5Ym9yZ0RhdGEuZm9jdXNPdXRIYW5kbGVyLFxuICAgIHRydWVcbiAgKTtcbiAgZnVuY3Rpb24gZm9jdXMoKSB7XG4gICAgY29uc3Qga2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQgPSBrd2luLl9fa2V5Ym9yZ0RhdGE7XG4gICAgaWYgKGtleWJvcmdOYXRpdmVGb2N1c0V2ZW50KSB7XG4gICAgICBrZXlib3JnTmF0aXZlRm9jdXNFdmVudC5sYXN0Rm9jdXNlZFByb2dyYW1tYXRpY2FsbHkgPSBuZXcgV2Vha1JlZkluc3RhbmNlKFxuICAgICAgICB0aGlzXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gb3JpZ0ZvY3VzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cbiAgbGV0IGFjdGl2ZUVsZW1lbnQgPSBrd2luLmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gIHdoaWxlIChhY3RpdmVFbGVtZW50ICYmIGFjdGl2ZUVsZW1lbnQuc2hhZG93Um9vdCkge1xuICAgIG9uRm9jdXNJbihhY3RpdmVFbGVtZW50KTtcbiAgICBhY3RpdmVFbGVtZW50ID0gYWN0aXZlRWxlbWVudC5zaGFkb3dSb290LmFjdGl2ZUVsZW1lbnQ7XG4gIH1cbiAgZm9jdXMuX19rZXlib3JnTmF0aXZlRm9jdXMgPSBvcmlnRm9jdXM7XG59XG5mdW5jdGlvbiBkaXNwb3NlRm9jdXNFdmVudCh3aW4pIHtcbiAgY29uc3Qga3dpbiA9IHdpbjtcbiAgY29uc3QgcHJvdG8gPSBrd2luLkhUTUxFbGVtZW50LnByb3RvdHlwZTtcbiAgY29uc3Qgb3JpZ0ZvY3VzID0gcHJvdG8uZm9jdXMuX19rZXlib3JnTmF0aXZlRm9jdXM7XG4gIGNvbnN0IGtleWJvcmdOYXRpdmVGb2N1c0V2ZW50ID0ga3dpbi5fX2tleWJvcmdEYXRhO1xuICBpZiAoa2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQpIHtcbiAgICBrd2luLmRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICBcImZvY3VzaW5cIixcbiAgICAgIGtleWJvcmdOYXRpdmVGb2N1c0V2ZW50LmZvY3VzSW5IYW5kbGVyLFxuICAgICAgdHJ1ZVxuICAgICk7XG4gICAga3dpbi5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgXCJmb2N1c291dFwiLFxuICAgICAga2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQuZm9jdXNPdXRIYW5kbGVyLFxuICAgICAgdHJ1ZVxuICAgICk7XG4gICAgZm9yIChjb25zdCBzaGFkb3dSb290V2Vha1JlZiBvZiBrZXlib3JnTmF0aXZlRm9jdXNFdmVudC5zaGFkb3dUYXJnZXRzKSB7XG4gICAgICBjb25zdCBzaGFkb3dSb290ID0gc2hhZG93Um9vdFdlYWtSZWYuZGVyZWYoKTtcbiAgICAgIGlmIChzaGFkb3dSb290KSB7XG4gICAgICAgIHNoYWRvd1Jvb3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICBcImZvY3VzaW5cIixcbiAgICAgICAgICBrZXlib3JnTmF0aXZlRm9jdXNFdmVudC5mb2N1c0luSGFuZGxlcixcbiAgICAgICAgICB0cnVlXG4gICAgICAgICk7XG4gICAgICAgIHNoYWRvd1Jvb3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICBcImZvY3Vzb3V0XCIsXG4gICAgICAgICAga2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQuZm9jdXNPdXRIYW5kbGVyLFxuICAgICAgICAgIHRydWVcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAga2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQuc2hhZG93VGFyZ2V0cy5jbGVhcigpO1xuICAgIGRlbGV0ZSBrd2luLl9fa2V5Ym9yZ0RhdGE7XG4gIH1cbiAgaWYgKG9yaWdGb2N1cykge1xuICAgIHByb3RvLmZvY3VzID0gb3JpZ0ZvY3VzO1xuICB9XG59XG5mdW5jdGlvbiBnZXRMYXN0Rm9jdXNlZFByb2dyYW1tYXRpY2FsbHkod2luKSB7XG4gIHZhciBfYTtcbiAgY29uc3Qga2V5Ym9yZ05hdGl2ZUZvY3VzRXZlbnQgPSB3aW4uX19rZXlib3JnRGF0YTtcbiAgcmV0dXJuIGtleWJvcmdOYXRpdmVGb2N1c0V2ZW50ID8gKChfYSA9IGtleWJvcmdOYXRpdmVGb2N1c0V2ZW50Lmxhc3RGb2N1c2VkUHJvZ3JhbW1hdGljYWxseSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmRlcmVmKCkpIHx8IG51bGwgOiB2b2lkIDA7XG59XG5cbi8vIHNyYy9LZXlib3JnLnRzXG52YXIgX2Rpc21pc3NUaW1lb3V0ID0gNTAwO1xudmFyIF9sYXN0SWQgPSAwO1xudmFyIEtleWJvcmdDb3JlID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcih3aW4sIHByb3BzKSB7XG4gICAgdGhpcy5faXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkX0RPX05PVF9VU0UgPSBmYWxzZTtcbiAgICB0aGlzLl9vbkZvY3VzSW4gPSAoZSkgPT4ge1xuICAgICAgaWYgKHRoaXMuX2lzTW91c2VPclRvdWNoVXNlZFRpbWVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBkZXRhaWxzID0gZS5kZXRhaWw7XG4gICAgICBpZiAoIWRldGFpbHMucmVsYXRlZFRhcmdldCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZGV0YWlscy5pc0ZvY3VzZWRQcm9ncmFtbWF0aWNhbGx5IHx8IGRldGFpbHMuaXNGb2N1c2VkUHJvZ3JhbW1hdGljYWxseSA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkID0gdHJ1ZTtcbiAgICB9O1xuICAgIHRoaXMuX29uTW91c2VEb3duID0gKGUpID0+IHtcbiAgICAgIGlmIChlLmJ1dHRvbnMgPT09IDAgfHwgZS5jbGllbnRYID09PSAwICYmIGUuY2xpZW50WSA9PT0gMCAmJiBlLnNjcmVlblggPT09IDAgJiYgZS5zY3JlZW5ZID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuX29uTW91c2VPclRvdWNoKCk7XG4gICAgfTtcbiAgICB0aGlzLl9vbk1vdXNlT3JUb3VjaCA9ICgpID0+IHtcbiAgICAgIGNvbnN0IHdpbiA9IHRoaXMuX3dpbjtcbiAgICAgIGlmICh3aW4pIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzTW91c2VPclRvdWNoVXNlZFRpbWVyKSB7XG4gICAgICAgICAgd2luLmNsZWFyVGltZW91dCh0aGlzLl9pc01vdXNlT3JUb3VjaFVzZWRUaW1lcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faXNNb3VzZU9yVG91Y2hVc2VkVGltZXIgPSB3aW4uc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgZGVsZXRlIHRoaXMuX2lzTW91c2VPclRvdWNoVXNlZFRpbWVyO1xuICAgICAgICB9LCAxZTMpO1xuICAgICAgfVxuICAgICAgdGhpcy5pc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQgPSBmYWxzZTtcbiAgICB9O1xuICAgIHRoaXMuX29uS2V5RG93biA9IChlKSA9PiB7XG4gICAgICBjb25zdCBpc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQgPSB0aGlzLmlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZDtcbiAgICAgIGlmIChpc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Nob3VsZERpc21pc3NLZXlib2FyZE5hdmlnYXRpb24oZSkpIHtcbiAgICAgICAgICB0aGlzLl9zY2hlZHVsZURpc21pc3MoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHRoaXMuX3Nob3VsZFRyaWdnZXJLZXlib2FyZE5hdmlnYXRpb24oZSkpIHtcbiAgICAgICAgICB0aGlzLmlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuaWQgPSBcImNcIiArICsrX2xhc3RJZDtcbiAgICB0aGlzLl93aW4gPSB3aW47XG4gICAgY29uc3QgZG9jID0gd2luLmRvY3VtZW50O1xuICAgIGlmIChwcm9wcykge1xuICAgICAgY29uc3QgdHJpZ2dlcktleXMgPSBwcm9wcy50cmlnZ2VyS2V5cztcbiAgICAgIGNvbnN0IGRpc21pc3NLZXlzID0gcHJvcHMuZGlzbWlzc0tleXM7XG4gICAgICBpZiAodHJpZ2dlcktleXMgPT0gbnVsbCA/IHZvaWQgMCA6IHRyaWdnZXJLZXlzLmxlbmd0aCkge1xuICAgICAgICB0aGlzLl90cmlnZ2VyS2V5cyA9IG5ldyBTZXQodHJpZ2dlcktleXMpO1xuICAgICAgfVxuICAgICAgaWYgKGRpc21pc3NLZXlzID09IG51bGwgPyB2b2lkIDAgOiBkaXNtaXNzS2V5cy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5fZGlzbWlzc0tleXMgPSBuZXcgU2V0KGRpc21pc3NLZXlzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoS0VZQk9SR19GT0NVU0lOLCB0aGlzLl9vbkZvY3VzSW4sIHRydWUpO1xuICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX29uTW91c2VEb3duLCB0cnVlKTtcbiAgICB3aW4uYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5fb25LZXlEb3duLCB0cnVlKTtcbiAgICBkb2MuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgdGhpcy5fb25Nb3VzZU9yVG91Y2gsIHRydWUpO1xuICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgdGhpcy5fb25Nb3VzZU9yVG91Y2gsIHRydWUpO1xuICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hjYW5jZWxcIiwgdGhpcy5fb25Nb3VzZU9yVG91Y2gsIHRydWUpO1xuICAgIHNldHVwRm9jdXNFdmVudCh3aW4pO1xuICB9XG4gIGdldCBpc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzTmF2aWdhdGluZ1dpdGhLZXlib2FyZF9ET19OT1RfVVNFO1xuICB9XG4gIHNldCBpc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQodmFsKSB7XG4gICAgaWYgKHRoaXMuX2lzTmF2aWdhdGluZ1dpdGhLZXlib2FyZF9ET19OT1RfVVNFICE9PSB2YWwpIHtcbiAgICAgIHRoaXMuX2lzTmF2aWdhdGluZ1dpdGhLZXlib2FyZF9ET19OT1RfVVNFID0gdmFsO1xuICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9XG4gIH1cbiAgZGlzcG9zZSgpIHtcbiAgICBjb25zdCB3aW4gPSB0aGlzLl93aW47XG4gICAgaWYgKHdpbikge1xuICAgICAgaWYgKHRoaXMuX2lzTW91c2VPclRvdWNoVXNlZFRpbWVyKSB7XG4gICAgICAgIHdpbi5jbGVhclRpbWVvdXQodGhpcy5faXNNb3VzZU9yVG91Y2hVc2VkVGltZXIpO1xuICAgICAgICB0aGlzLl9pc01vdXNlT3JUb3VjaFVzZWRUaW1lciA9IHZvaWQgMDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLl9kaXNtaXNzVGltZXIpIHtcbiAgICAgICAgd2luLmNsZWFyVGltZW91dCh0aGlzLl9kaXNtaXNzVGltZXIpO1xuICAgICAgICB0aGlzLl9kaXNtaXNzVGltZXIgPSB2b2lkIDA7XG4gICAgICB9XG4gICAgICBkaXNwb3NlRm9jdXNFdmVudCh3aW4pO1xuICAgICAgY29uc3QgZG9jID0gd2luLmRvY3VtZW50O1xuICAgICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoS0VZQk9SR19GT0NVU0lOLCB0aGlzLl9vbkZvY3VzSW4sIHRydWUpO1xuICAgICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5fb25Nb3VzZURvd24sIHRydWUpO1xuICAgICAgd2luLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX29uS2V5RG93biwgdHJ1ZSk7XG4gICAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgdGhpcy5fb25Nb3VzZU9yVG91Y2gsIHRydWUpO1xuICAgICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCB0aGlzLl9vbk1vdXNlT3JUb3VjaCwgdHJ1ZSk7XG4gICAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoY2FuY2VsXCIsIHRoaXMuX29uTW91c2VPclRvdWNoLCB0cnVlKTtcbiAgICAgIGRlbGV0ZSB0aGlzLl93aW47XG4gICAgfVxuICB9XG4gIGlzRGlzcG9zZWQoKSB7XG4gICAgcmV0dXJuICEhdGhpcy5fd2luO1xuICB9XG4gIC8qKlxuICAgKiBVcGRhdGVzIGFsbCBrZXlib3JnIGluc3RhbmNlcyB3aXRoIHRoZSBrZXlib2FyZCBuYXZpZ2F0aW9uIHN0YXRlXG4gICAqL1xuICB1cGRhdGUoKSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCBrZXlib3JncyA9IChfYiA9IChfYSA9IHRoaXMuX3dpbikgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLl9fa2V5Ym9yZykgPT0gbnVsbCA/IHZvaWQgMCA6IF9iLnJlZnM7XG4gICAgaWYgKGtleWJvcmdzKSB7XG4gICAgICBmb3IgKGNvbnN0IGlkIG9mIE9iamVjdC5rZXlzKGtleWJvcmdzKSkge1xuICAgICAgICBLZXlib3JnLnVwZGF0ZShrZXlib3Jnc1tpZF0sIHRoaXMuaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIEByZXR1cm5zIHdoZXRoZXIgdGhlIGtleWJvYXJkIGV2ZW50IHNob3VsZCB0cmlnZ2VyIGtleWJvYXJkIG5hdmlnYXRpb24gbW9kZVxuICAgKi9cbiAgX3Nob3VsZFRyaWdnZXJLZXlib2FyZE5hdmlnYXRpb24oZSkge1xuICAgIHZhciBfYTtcbiAgICBpZiAoZS5rZXkgPT09IFwiVGFiXCIpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBjb25zdCBhY3RpdmVFbGVtZW50ID0gKF9hID0gdGhpcy5fd2luKSA9PSBudWxsID8gdm9pZCAwIDogX2EuZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICBjb25zdCBpc1RyaWdnZXJLZXkgPSAhdGhpcy5fdHJpZ2dlcktleXMgfHwgdGhpcy5fdHJpZ2dlcktleXMuaGFzKGUua2V5Q29kZSk7XG4gICAgY29uc3QgaXNFZGl0YWJsZSA9IGFjdGl2ZUVsZW1lbnQgJiYgKGFjdGl2ZUVsZW1lbnQudGFnTmFtZSA9PT0gXCJJTlBVVFwiIHx8IGFjdGl2ZUVsZW1lbnQudGFnTmFtZSA9PT0gXCJURVhUQVJFQVwiIHx8IGFjdGl2ZUVsZW1lbnQuaXNDb250ZW50RWRpdGFibGUpO1xuICAgIHJldHVybiBpc1RyaWdnZXJLZXkgJiYgIWlzRWRpdGFibGU7XG4gIH1cbiAgLyoqXG4gICAqIEByZXR1cm5zIHdoZXRoZXIgdGhlIGtleWJvYXJkIGV2ZW50IHNob3VsZCBkaXNtaXNzIGtleWJvYXJkIG5hdmlnYXRpb24gbW9kZVxuICAgKi9cbiAgX3Nob3VsZERpc21pc3NLZXlib2FyZE5hdmlnYXRpb24oZSkge1xuICAgIHZhciBfYTtcbiAgICByZXR1cm4gKF9hID0gdGhpcy5fZGlzbWlzc0tleXMpID09IG51bGwgPyB2b2lkIDAgOiBfYS5oYXMoZS5rZXlDb2RlKTtcbiAgfVxuICBfc2NoZWR1bGVEaXNtaXNzKCkge1xuICAgIGNvbnN0IHdpbiA9IHRoaXMuX3dpbjtcbiAgICBpZiAod2luKSB7XG4gICAgICBpZiAodGhpcy5fZGlzbWlzc1RpbWVyKSB7XG4gICAgICAgIHdpbi5jbGVhclRpbWVvdXQodGhpcy5fZGlzbWlzc1RpbWVyKTtcbiAgICAgICAgdGhpcy5fZGlzbWlzc1RpbWVyID0gdm9pZCAwO1xuICAgICAgfVxuICAgICAgY29uc3Qgd2FzID0gd2luLmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gICAgICB0aGlzLl9kaXNtaXNzVGltZXIgPSB3aW4uc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMuX2Rpc21pc3NUaW1lciA9IHZvaWQgMDtcbiAgICAgICAgY29uc3QgY3VyID0gd2luLmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gICAgICAgIGlmICh3YXMgJiYgY3VyICYmIHdhcyA9PT0gY3VyKSB7XG4gICAgICAgICAgdGhpcy5pc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSwgX2Rpc21pc3NUaW1lb3V0KTtcbiAgICB9XG4gIH1cbn07XG52YXIgS2V5Ym9yZyA9IGNsYXNzIF9LZXlib3JnIHtcbiAgY29uc3RydWN0b3Iod2luLCBwcm9wcykge1xuICAgIHRoaXMuX2NiID0gW107XG4gICAgdGhpcy5faWQgPSBcImtcIiArICsrX2xhc3RJZDtcbiAgICB0aGlzLl93aW4gPSB3aW47XG4gICAgY29uc3QgY3VycmVudCA9IHdpbi5fX2tleWJvcmc7XG4gICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgIHRoaXMuX2NvcmUgPSBjdXJyZW50LmNvcmU7XG4gICAgICBjdXJyZW50LnJlZnNbdGhpcy5faWRdID0gdGhpcztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fY29yZSA9IG5ldyBLZXlib3JnQ29yZSh3aW4sIHByb3BzKTtcbiAgICAgIHdpbi5fX2tleWJvcmcgPSB7XG4gICAgICAgIGNvcmU6IHRoaXMuX2NvcmUsXG4gICAgICAgIHJlZnM6IHsgW3RoaXMuX2lkXTogdGhpcyB9XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBzdGF0aWMgY3JlYXRlKHdpbiwgcHJvcHMpIHtcbiAgICByZXR1cm4gbmV3IF9LZXlib3JnKHdpbiwgcHJvcHMpO1xuICB9XG4gIHN0YXRpYyBkaXNwb3NlKGluc3RhbmNlKSB7XG4gICAgaW5zdGFuY2UuZGlzcG9zZSgpO1xuICB9XG4gIC8qKlxuICAgKiBVcGRhdGVzIGFsbCBzdWJzY3JpYmVkIGNhbGxiYWNrcyB3aXRoIHRoZSBrZXlib2FyZCBuYXZpZ2F0aW9uIHN0YXRlXG4gICAqL1xuICBzdGF0aWMgdXBkYXRlKGluc3RhbmNlLCBpc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQpIHtcbiAgICBpbnN0YW5jZS5fY2IuZm9yRWFjaCgoY2FsbGJhY2spID0+IGNhbGxiYWNrKGlzTmF2aWdhdGluZ1dpdGhLZXlib2FyZCkpO1xuICB9XG4gIGRpc3Bvc2UoKSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IGN1cnJlbnQgPSAoX2EgPSB0aGlzLl93aW4pID09IG51bGwgPyB2b2lkIDAgOiBfYS5fX2tleWJvcmc7XG4gICAgaWYgKGN1cnJlbnQgPT0gbnVsbCA/IHZvaWQgMCA6IGN1cnJlbnQucmVmc1t0aGlzLl9pZF0pIHtcbiAgICAgIGRlbGV0ZSBjdXJyZW50LnJlZnNbdGhpcy5faWRdO1xuICAgICAgaWYgKE9iamVjdC5rZXlzKGN1cnJlbnQucmVmcykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGN1cnJlbnQuY29yZS5kaXNwb3NlKCk7XG4gICAgICAgIGRlbGV0ZSB0aGlzLl93aW4uX19rZXlib3JnO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICBgS2V5Ym9yZyBpbnN0YW5jZSAke3RoaXMuX2lkfSBpcyBiZWluZyBkaXNwb3NlZCBpbmNvcnJlY3RseS5gXG4gICAgICApO1xuICAgIH1cbiAgICB0aGlzLl9jYiA9IFtdO1xuICAgIGRlbGV0ZSB0aGlzLl9jb3JlO1xuICAgIGRlbGV0ZSB0aGlzLl93aW47XG4gIH1cbiAgLyoqXG4gICAqIEByZXR1cm5zIFdoZXRoZXIgdGhlIHVzZXIgaXMgbmF2aWdhdGluZyB3aXRoIGtleWJvYXJkXG4gICAqL1xuICBpc05hdmlnYXRpbmdXaXRoS2V5Ym9hcmQoKSB7XG4gICAgdmFyIF9hO1xuICAgIHJldHVybiAhISgoX2EgPSB0aGlzLl9jb3JlKSA9PSBudWxsID8gdm9pZCAwIDogX2EuaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkKTtcbiAgfVxuICAvKipcbiAgICogQHBhcmFtIGNhbGxiYWNrIC0gQ2FsbGVkIHdoZW4gdGhlIGtleWJvYXJkIG5hdmlnYXRpb24gc3RhdGUgY2hhbmdlc1xuICAgKi9cbiAgc3Vic2NyaWJlKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5fY2IucHVzaChjYWxsYmFjayk7XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSBjYWxsYmFjayAtIFJlZ2lzdGVyZWQgd2l0aCBzdWJzY3JpYmVcbiAgICovXG4gIHVuc3Vic2NyaWJlKGNhbGxiYWNrKSB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLl9jYi5pbmRleE9mKGNhbGxiYWNrKTtcbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgdGhpcy5fY2Iuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIE1hbnVhbGx5IHNldCB0aGUga2V5Ym9hcmQgbmF2aWd0aW9uIHN0YXRlXG4gICAqL1xuICBzZXRWYWwoaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkKSB7XG4gICAgaWYgKHRoaXMuX2NvcmUpIHtcbiAgICAgIHRoaXMuX2NvcmUuaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkID0gaXNOYXZpZ2F0aW5nV2l0aEtleWJvYXJkO1xuICAgIH1cbiAgfVxufTtcbmZ1bmN0aW9uIGNyZWF0ZUtleWJvcmcod2luLCBwcm9wcykge1xuICByZXR1cm4gS2V5Ym9yZy5jcmVhdGUod2luLCBwcm9wcyk7XG59XG5mdW5jdGlvbiBkaXNwb3NlS2V5Ym9yZyhpbnN0YW5jZSkge1xuICBLZXlib3JnLmRpc3Bvc2UoaW5zdGFuY2UpO1xufVxuXG4vLyBzcmMvaW5kZXgudHNcbnZhciB2ZXJzaW9uID0gXCIyLjYuMFwiO1xuZXhwb3J0IHtcbiAgS0VZQk9SR19GT0NVU0lOLFxuICBLRVlCT1JHX0ZPQ1VTT1VULFxuICBjcmVhdGVLZXlib3JnLFxuICBkaXNwb3NlS2V5Ym9yZyxcbiAgZ2V0TGFzdEZvY3VzZWRQcm9ncmFtbWF0aWNhbGx5LFxuICBuYXRpdmVGb2N1cyxcbiAgdmVyc2lvblxufTtcbi8qIVxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXG4gKi9cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/keyborg/dist/esm/index.js\n");

/***/ })

};
;